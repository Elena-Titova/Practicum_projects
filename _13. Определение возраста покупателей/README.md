# Описание проекта "Определение возраста покупателей" 
***проект модуля "Компьютерное зрение"***

## Цель исследования

Сетевой супермаркет «Хлеб-Соль» внедряет систему компьютерного зрения для обработки фотографий покупателей. Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы:
 - анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
 - контролировать добросовестность кассиров при продаже алкоголя;

Необходимо построить модель, которая по фотографии определит приблизительный возраст человека. В нашем распоряжении набор фотографий людей с указанием возраста.


## Описание данных

Данные взяты с сайта ChaLearn Looking at People. Они находятся в папке /datasets/faces/. 
В нашем распоряжении одна папка со всеми изображениями (/final_files) и CSV-файл labels.csv с двумя колонками: file_name и real_age. 
Извлечь данные из папки нам поможет новый метод ImageDataGenerator —flow_from_dataframe(dataframe, directory, ...).


## Ход исследования

В рамках проекта было выполнено:
- проведен исследовательский анализ набора фотографий;
- подготовлены данные к обучению;
- обучена нейронная сеть и рассчитано её качество.


## Итоги исследования

В рамках исследовательского анализа данных получены промежуточные выводы:
 - размер выборки: около 7,5 тысяч изображений;
 - праспределение возраста смещено влево: много изображений людей до 30 лет, меньше — старших возрастов;
 - изображения разнообразны, присутствуют разные ракурсы, освещение, фон, выражения лиц и т.д.

Неравномерность распределения возрастов может привести к смещённому обучению — модель будет лучше предсказывать молодые возраста.

Анализ обученной модели:
 - Обучение и валидация идут успешно - значения метрики mae (средняя абсолютная ошибка) постепенно уменьшаются как на тренировочных, так и на валидационных данных. Это хороший признак — модель учится.
 - Финальное значение mae на валидации примерно 6.87, что соответствует условию задачи.
 - Вывод модели (loss и mae на тесте) совпадает с последней эпохой, значит сохранённые веса и восстановленные при restore_best_weights=True работают корректно.

Вывод - можно сказать, что система предсказывет возраст с погрешностью примерно в 7 лет, это, конечно, не обеспечит стопроцентную гарантию, что алкоголь не попадет в руки несовершеннолетним, но поможет минимизировать процент нарушений, а также поможет давать рекомендации в соответствии с возрастом и, тем самым, повысить лояльность покупателя.







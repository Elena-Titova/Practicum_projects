# Описание проекта "Молочное хозяйство" 

## Цель исследования

Наша IT-компания выполняет на заказ проекты по машинному обучению. К нам обратился фермер, владелец молочного хозяйства «Вольный луг». Он хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ «ЭкоФерма». Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а её надой был вкусным — строго по его критериям.

Цель проекта - разработать модель машинного обучения, которая поможет фермеру управлять рисками и принимать объективное решение о покупке. Необходимо создать две прогнозные модели для отбора бурёнок в поголовье:

первая будет прогнозировать возможный удой коровы (целевой признак Удой);
вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак Вкус молока).
С помощью модели нужно отобрать коров по двум критериям:

 - средний удой за год — не менее 6000 килограммов;
 - молоко должно быть вкусным.

## Описание данных
Файл ferma_main.csv (содержит данные о стаде фермера на текущий момент):
 - id — уникальный идентификатор коровы
 - Удой, кг — масса молока, которую корова даёт в год (в килограммах)
 - ЭКЕ (Энергетическая кормовая единица) — показатель питательности корма коровы
 - Сырой протеин, г — содержание сырого протеина в корме (в граммах)
 - СПО (Сахаро-протеиновое соотношение) — отношение сахара к протеину в корме коровы
 - Порода — порода коровы
 - Тип пастбища — ландшафт лугов, на которых паслась корова
 - Gорода папы_быка — порода папы коровы
 - Жирность,% — содержание жиров в молоке (в процентах)
 - Белок,% — содержание белков в молоке (в процентах)
 - Вкус молока — оценка вкуса по личным критериям фермера, бинарный признак (вкусно, не вкусно)
 - Возраст — возраст коровы, бинарный признак (менее_2_лет, более_2_лет)
Признаки в датасете ferma_main.csv можно разделить на группы:
 - Характеристики коровы: id, Порода, порода папы_быка, Возраст
 - Характеристики корма: ЭКЕ (Энергетическая кормовая единица), Сырой протеин, г, СПО (Сахаро-протеиновое соотношение)
 - Характеристика пастбища: Тип пастбища
 - Характеристики молока: Удой, кг, Жирность,%, Белок,%, Вкус молока
Такое разделение поможет вам понять, как взаимосвязаны признаки в датасете.

Файл ferma_dad.csv хранит имя папы каждой коровы в стаде фермера:
 - id — уникальный идентификатор коровы
 - Имя Папы — имя папы коровы

Файл cow_buy.csv — это данные о коровах «ЭкоФермы», которых фермер хочет изучить перед покупкой:
 - Порода — порода коровы
 - Тип пастбища — ландшафт лугов, на которых паслась корова
 - Порода папы_быка — порода папы коровы
 - Имя_папы — имя папы коровы
 - Текущая_жирность,% — содержание жиров в молоке (в процентах)
 - Текущий_уровень_белок,% — содержание белков в молоке (в процентах)
 - Возраст — возраст коровы, бинарный признак (менее_2_лет, более_2_лет)

Данные в файлах ferma_main.csv и cow_buy.csv похожи, но у датасета cow_buy.csv несколько особенностей.
Содержание белков и жиров в молоке указано на момент продажи — когда «ЭкоФерма» давала коровам свой корм.
Параметры корма ЭКЕ (Энергетическая кормовая единица), Сырой протеин, г и СПО (Сахаро-протеиновое соотношение) отсутствуют. Технологи заказчика пересмотрели подход к кормлению: для новых коров планируется увеличить значения каждого из этих параметров на 5%.
Кроме того, отсутствуют признаки Удой, кг и Вкус молока. Это целевые признаки, именно их предстоит предсказать.


## Ход исследования

В рамках проведенной работы нами были загружены и изучены данные из файла, обработаны дубликаты, аномальные значения в таблицах, выполнено преобразование типа данных.

Перед нами стояло две задачи - задача регрессии (где целевым показателем был удой) и задача классификации (где целевым показателем был вкус молока).

Мы построили три модели линейной регрессии, выбрали лучшую из них и на ее основе спрогнозировали показатель "удой_кг". Для улучшения качества регрессионной модели улучшено качество данных (исключены выбросы и дубликаты), выполнено масштабирование количественных данных и кодирование категориальных данных, а также были отобраны входные признаки для обучения модели. Можно улучшить результаты регрессионной модели, например, увеличив объем данных или проведя более глубокий анализ признаков.


## Итоги исследования

В результате проведенной работы мы получили прогнозы вкуса молока и удоя коров «ЭкоФермы» в датафрейм с коровами, покупку которых рассматривает фермер.

Получилось, что под критерии (удой более 6000 килограммов в год и вкусное молоко) подходит только одна корова:
порода	                                РефлешнСоверинг
тип_пастбища                            холмистое	
порода_папы_быка                        Айдиал
имя_папы	                              Буйный
текущая_жирность_%	                    3.4	
текущий_уровень_белка_%	                3.079
возраст	                                менее_2_лет
эке_энергетическая_кормовая_единица	    15.276162
спо_сахаро-протеиновое_соотношение	    0.958744
сырой_протеин_г	                        2019.947532
спо_категория	                          1	
предсказанный_удой	                    6398.012445
предсказанный_вкус                      вкусно

Стоит также отметить, что при анализе рисков или экономических расчетов важны следующие метрики моделей классификации:
 - accuracy - доля правильных предсказаний
 - precision - доля истинных положительных предсказаний среди всех положительных предсказаний.
 - recall - cпособность модели находить все положительные примеры Обучили модель логистической регресии, а также с помощью обученной модели спрогнозировали вкус молока коров, которых фермер хочет купить.

